{"version":3,"file":"ticker.js","sourceRoot":"","sources":["ticker.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,qBAAqB,EAAE,oBAAoB,EAAE,MAAM,qBAAqB,CAAC;AAElF;IAOI,gBAAY,GAA6B,EAAE,OAA+C;QAC9E,IAAA,GAAG,GAAuB,OAAO,IAA9B,EAAE,KAAqB,OAAO,UAAZ,EAAhB,SAAS,mBAAG,IAAI,KAAA,CAAa;QAC1C,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC;QACf,IAAI,CAAC,GAAG,GAAG,GAAG,IAAI,IAAI,GAAG,EAAE,CAAC;QAC5B,IAAI,CAAC,UAAU,GAAG,cAAO,CAAC,CAAC;QAC3B,IAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;IAClB,CAAC;IAED,qBAAI,GAAJ;QACI,IAAI,GAAG,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QACrB,IAAI,EAAE,GAAG,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC;QAEzB,IAAI,IAAI,CAAC,SAAS,EAAE;YAElB,IAAI,IAAI,CAAC,UAAU,IAAI,EAAE,IAAI,IAAI,CAAC,GAAG,EAAE;gBACnC,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;gBACpB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC;aACnB;SACF;aAAM;YACL,IAAI,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;SACrB;QAED,IAAI,CAAC,EAAE,GAAG,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAC1D,CAAC;IAED,sBAAK,GAAL;QACI,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QACvB,IAAI,CAAC,EAAE,GAAG,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IAC1D,CAAC;IAED,qBAAI,GAAJ;QACI,IAAI,IAAI,CAAC,EAAE,KAAK,IAAI,EAAE;YAClB,oBAAoB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAC9B,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC;YACd,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC;SAClB;IACL,CAAC;IAED,8BAAa,GAAb,UAAc,EAAwB;QAClC,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;IACzB,CAAC;IACL,aAAC;AAAD,CAAC,AAjDD,IAiDC","sourcesContent":["import { requestAnimationFrame, cancelAnimationFrame } from '#/vendor/rafPolifil';\n\nexport default class Ticker {\n    id: number | null;\n    fps: number;\n    updateFunc: (dt: number) => void;\n    tieRender?: boolean;\n    time: number; \n\n    constructor(ctx: CanvasRenderingContext2D, options: { FPS?: number; tieRender?: boolean; }) {\n        const { FPS, tieRender = true } = options;\n        this.id = null;\n        this.fps = FPS || 1000 / 60;\n        this.updateFunc = () => {};\n        this.tieRender = tieRender;\n        this.time = 0;\n    }\n\n    tick() {\n        var now = Date.now();\n        var dt = now - this.time;\n\n        if (this.tieRender) {\n\n          if (this.updateFunc && dt >= this.fps) {\n              this.updateFunc(dt);\n              this.time = now;\n          }\n        } else {\n          this.updateFunc(dt);\n        }\n\n        this.id = requestAnimationFrame(this.tick.bind(this));\n    }\n\n    start() {\n        this.time = Date.now();\n        this.id = requestAnimationFrame(this.tick.bind(this));\n    }\n\n    stop() {\n        if (this.id !== null) {\n            cancelAnimationFrame(this.id);\n            this.time = 0;\n            this.id = null;\n        }\n    }\n\n    setUpdateFunc(cb: (dt: number) => void) {\n        this.updateFunc = cb;\n    }\n}\n"]}